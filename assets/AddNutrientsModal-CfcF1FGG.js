import{u as n,M as N}from"./DoubleCheckModal-CpxpnQ_P.js";import{u}from"./foodDataStore-CuRjDprF.js";import{m as c,g as h,_ as y,o,c as r,d as e,F as m,e as p,t as f,h as _,j as g,l as O}from"./index-B2AOrsMC.js";const k={data(){const s=n();return{modal:null,nutrients:[],filteredNutrients:[],addNutrients:[],product:null,productList:null,addNTsBtb:!0,localAddOthersNutrients:[...s.addOthersNutrients]}},computed:{...c(u,["headerChineseAndEnglish","myProductList"]),...c(n,["addOthersNutrients"])},watch:{localAddOthersNutrients(s){n().addOthersNutrients=s}},methods:{...h(u,["setMyProducts"]),...h(n,["addCustomNutrients","clearAddOtherNts"]),searchNutrient(s){this.filteredNutrients=Object.fromEntries(Object.entries(this.nutrients).filter(([,t])=>t.match(s)))},updateFilterData(){const s={...this.headerChineseAndEnglish};["id","category","sample_name","common_name","content_description","scrap_rate","calories","corrected_calories","protein","fat","saturated_fat","total_carbohydrates","total_sugar","sodium","trans_fat"].forEach(t=>{delete s[t]}),this.filteredNutrients=s,this.nutrients=s},addNTs(){this.productList.forEach(s=>{s.id===this.product.id&&(s.addNutrients=this.addOthersNutrients)}),this.setMyProducts(this.productList),this.hideModal(),this.clearAddOtherNts()},showModal(s){this.addNTsBtb=!0,this.product={...s},this.addNutrients=[],s.addNutrients&&(this.localAddOthersNutrients=s.addNutrients),this.modal.show()},showCustomModal(){this.modal.show(),this.addNTsBtb=!1},addCustomFoodNTs(){this.addCustomNutrients(this.localAddOthersNutrients),this.hideModal()},hideModal(){this.modal.hide()}},created(){this.updateFilterData(),this.productList=this.myProductList},mounted(){this.modal=new N(this.$refs.nutrientsModal)}},C={ref:"nutrientsModal",class:"modal",tabindex:"-1"},v={class:"modal-dialog modal-dialog-scrollable"},A={class:"modal-content"},M={class:"modal-header flex-column align-items-start"},w={class:"w-100 form-floating"},x={key:0,class:"mt-3 d-flex flex-wrap justify-content-start align-items-center"},T={class:"modal-body"},F={key:0},B=["id","value"],L=["for"],j={class:"modal-footer"};function E(s,t,S,D,a,i){return o(),r("div",C,[e("div",v,[e("div",A,[e("div",M,[t[6]||(t[6]=e("div",{class:"w-100 mb-3 p-2 d-flex justify-content-between"},[e("h5",{class:"modal-title"},"新增其他營養素"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),e("section",w,[e("input",{onChange:t[0]||(t[0]=d=>i.searchNutrient(d.target.value)),type:"search",class:"form-control",id:"searchInput",placeholder:"請輸入欲新增營養素搜尋"},null,32),t[4]||(t[4]=e("label",{for:"searchInput"},"請輸入營養素搜尋",-1))]),s.addOthersNutrients.length>0?(o(),r("div",x,[t[5]||(t[5]=e("span",{class:"ms-1"},"已新增營養素：",-1)),(o(!0),r(m,null,p(a.localAddOthersNutrients,d=>(o(),r("span",{key:d,class:"border badge text-bg-light fs-6 m-1"},f(a.nutrients[d]),1))),128))])):_("",!0)]),e("div",T,[Object.values(a.filteredNutrients).length===0?(o(),r("div",F,t[7]||(t[7]=[e("p",{class:"mb-0 text-center fw-bold"},"查無相符品項",-1)]))):(o(!0),r(m,{key:1},p(a.filteredNutrients,(d,l)=>(o(),r("div",{key:l,class:"form-check px-4 py-1 ms-2"},[g(e("input",{"onUpdate:modelValue":t[1]||(t[1]=b=>a.localAddOthersNutrients=b),class:"form-check-input",type:"checkbox",id:d,value:l},null,8,B),[[O,a.localAddOthersNutrients]]),e("label",{class:"form-check-label",for:d},f(d),9,L)]))),128))]),e("div",j,[t[8]||(t[8]=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 取消 ",-1)),a.addNTsBtb?(o(),r("button",{key:0,onClick:t[2]||(t[2]=(...d)=>i.addNTs&&i.addNTs(...d)),type:"button",class:"btn btn-primary"}," 新增 ")):(o(),r("button",{key:1,onClick:t[3]||(t[3]=(...d)=>i.addCustomFoodNTs&&i.addCustomFoodNTs(...d)),type:"button",class:"btn btn-primary"}," 新增自訂義食材營養素 "))])])])],512)}const U=y(k,[["render",E]]);export{U as A};
