import{u as I,a as V,b as F}from"./component-functions-BFTXm8zL.js";import{_ as B,o as i,c as n,a as s,i as h,f as r,g as x,m as S,n as w,F as v,h as y,B as E,d as g,z as m,C as f,D as _,b as k,t as u,r as C}from"./index-5vm-J8XD.js";import{C as N}from"./CustomizeBaseDataModal-CrzuWEV5.js";import{M as A}from"./DoubleCheckModal-EWfacPVz.js";import"./selector-engine-BAtv4zJi.js";const D="/nutrition_label_tool/assets/%E7%87%9F%E9%A4%8A%E6%A8%99%E7%A4%BA-%E6%AF%8F%E4%B8%80%E4%BB%BD%E9%87%8F-BJDXuoBc.png",q="/nutrition_label_tool/assets/%E7%87%9F%E9%A4%8A%E6%A8%99%E7%A4%BA-%E5%90%AB%E5%B9%BE%E4%BB%BD-CbXbq5wp.png",j="/nutrition_label_tool/assets/ingredient-2-D1x0ESuD.png",U="/nutrition_label_tool/assets/ingredient-1-BZuXPh4b.png",P={data(){return{modal:{},imgName:"營養標示-每一份量.png",perServing:D,howMany:q,currentImg:D,currentView:""}},methods:{showModal(o){o==="perServing"&&(this.currentImg=this.perServing,this.currentView="showImg"),o==="howMany"&&(this.currentImg=this.howMany,this.currentView="showImg"),o==="productQty"&&(this.currentImg="",this.currentView=o),o==="totalWeight"&&(this.currentImg="",this.currentView=o),this.modal.show()},hideModal(){this.modal.hide()}},mounted(){this.modal=new A(this.$refs.instructionModal)}},L={ref:"instructionModal",class:"modal fade",tabindex:"-1"},Q={class:"modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable justify-content-center"},W={key:0,class:"modal-content"},H=["src","alt"],O={key:2,class:"modal-content"};function X(o,t,c,d,a,l){return i(),n("div",L,[s("div",Q,[a.currentView==="productQty"?(i(),n("div",W,t[0]||(t[0]=[h('<div class="modal-header bg-primary" data-v-fb66fdaf><h5 class="modal-title text-white" data-v-fb66fdaf>說明共可製成幾份</h5></div><div class="modal-body" data-v-fb66fdaf><p data-v-fb66fdaf> 例 1：總共有以下食材：娃娃菜、洋蔥、鴻喜菇、干貝...等，煮完可以分成 7 份。 </p><p data-v-fb66fdaf>因此這裡的欄位填入 <span class="fw-bold text-primary" data-v-fb66fdaf>7 </span></p><hr data-v-fb66fdaf><p data-v-fb66fdaf> 例 2：食材總量是 200 公克的白飯，我的成品每一份是 200 公克，所以 200 公克的白飯共可製成 1 份成品。 </p><p data-v-fb66fdaf> 因此這裡的欄位會填入 <span class="fw-bold text-primary" data-v-fb66fdaf>1</span></p></div><div class="modal-footer bg-light" data-v-fb66fdaf><button type="button" class="btn btn-secondary" data-bs-dismiss="modal" data-v-fb66fdaf> 關閉 </button></div>',3)]))):r("",!0),a.currentView==="showImg"?(i(),n("img",{key:1,src:a.currentImg,alt:a.imgName,class:"showImg"},null,8,H)):r("",!0),a.currentView==="totalWeight"?(i(),n("div",O,t[1]||(t[1]=[h('<div class="modal-header bg-primary" data-v-fb66fdaf><h5 class="modal-title text-white" data-v-fb66fdaf>說明 外包裝成分 及 總克數 欄位</h5></div><div class="modal-body" data-v-fb66fdaf><p class="fw-bold fs-5 ps-2 mb-3" data-v-fb66fdaf> 舉例，總共食材：娃娃菜 238 公克、洋蔥 172 公克、鴻喜菇 136 公克、干貝 20 公克...等，將用來製成 7 份的成品。 </p><p class="fw-bold fs-5 ps-2 mb-3" data-v-fb66fdaf> 以下欄位需填入這 7 份各食材所用的總克數。 </p><img class="ingredientImg mb-5 border" src="'+j+'" alt="ingredientImg" data-v-fb66fdaf><p class="fw-bold fs-5 ps-2 mb-3" data-v-fb66fdaf>2. 外包裝成分呈現範例</p><img class="ingredientImg border" src="'+U+'" alt="ingredientImg" data-v-fb66fdaf></div><div class="modal-footer bg-light" data-v-fb66fdaf><button type="button" class="btn btn-secondary" data-bs-dismiss="modal" data-v-fb66fdaf> 關閉 </button></div>',3)]))):r("",!0)])],512)}const T=B(P,[["render",X],["__scopeId","data-v-fb66fdaf"]]),J={data(){return{filteredData:[],alert:!1,filteredCustomizeData:[],isBuiltIn:!0,isCustomize:!1}},components:{CustomizeBaseDataModal:N,InstructionModal:T},watch:{customizeModal:{handler(o){o.switch===!1&&this.$route.path==="/nutrition_label"&&(this.showCustomizeDataBase(),this.searchFood(o.title),document.getElementById("searchInput").value=o.title)},deep:!0,immediate:!0}},computed:{...x(I,["baseFoodData","product"]),...x(V,["customizeDataList","customizeModal"])},methods:{...S(F,["openAlert"]),showBuiltInDataBase(){this.isBuiltIn=!0,this.isCustomize=!1},showCustomizeDataBase(){this.isCustomize=!0,this.isBuiltIn=!1},searchFood(o){const t=[];this.baseFoodData.filter(d=>{(d.sample_name&&d.sample_name.match(o)||d.common_name&&d.common_name.match(o))&&t.push(d)}),this.filteredData=t;const c=[];this.customizeDataList.filter(d=>{d.sample_name&&d.sample_name.match(o)&&c.push(d)}),this.filteredCustomizeData=c,this.filteredData.length===0&&this.filteredCustomizeData.length!==0&&this.showCustomizeDataBase(),this.filteredData.length!==0&&this.filteredCustomizeData.length===0&&this.showBuiltInDataBase()},chooseSample(o){const t=this.product.ingredients.find(c=>c.sample_name==="");t&&(t.id=Date.now(),t.details=o,t.sample_name=o.sample_name,o.common_name&&(t.common_name=o.common_name),t.details.category==="自定義"&&(o.sample_name===o.content_description?t.foodName=o.sample_name:t.foodName=o.sample_name+" ( "+o.content_description+" ) "))},addNewField(){const o={id:"",sample_name:"",foodName:"",grams:"",details:""};this.product.ingredients.push(o)},delField(o){const t=this.product.ingredients.indexOf(o);this.product.ingredients.splice(t,1)},submitForm(o){const t=o.target;if(!t.checkValidity()){t.classList.add("was-validated"),this.openAlert(!0,"還有必填欄位喔！");return}this.product.id?this.$router.push(`/edit_mark_items/${this.product.id}`):this.$router.push("/mark_items")},getAllData(){this.filteredData=this.baseFoodData,this.filteredCustomizeData=this.customizeDataList},openCustomizeBaseDataModal(){this.$refs.customizeBaseDataModal.showModal()},openInstructionModal(o){this.$refs.instructionModal.showModal(o)}},created(){this.getAllData()}},R={class:"mx-auto col-11 col-xxl-10 pb-5 mb-5"},Z={class:"form-floating mb-5 mx-1"},G={class:"col-12 ps-1"},K={class:"row col-12 mx-0 mb-5"},Y={class:"bg-light py-2 border rounded-3 col-5 col-xl-3"},$={class:"d-flex flex-wrap justify-content-center mb-2"},tt={key:0,class:"py-5 text-center"},st={key:1},et={key:0,class:"list-group rounded visibleHeight overflow-y-auto overflow-x-hidden"},ot=["onClick"],lt={class:"mb-0 px-2"},it={key:0,class:"mb-0 px-2 text-secondary"},nt={key:1,class:"mb-0 px-2 text-secondary"},at={key:0,class:"mt-5 text-center"},dt={key:1,class:"list-group rounded visibleHeight overflow-y-auto overflow-x-hidden"},rt=["onClick"],mt={class:"mb-0 px-2"},ut={key:0,class:"mb-0 px-2 text-secondary"},ct={key:0,class:"mt-5 text-center"},ft={class:"col-12 col-xl-6 mb-3"},pt={class:"col-12 col-xl-6 mb-3"},bt={for:"number_of_copies",class:"form-label fw-bold d-flex flex-wrap justify-content-start"},gt={class:"pe-1"},vt={class:"col-12 col-xl-6 d-flex mb-3"},yt={class:"col-12"},ht={for:"net_weight",class:"form-label fw-bold d-flex flex-wrap justify-content-start col-12"},xt={class:"infoStyle text-secondary fw-normal d-flex flex-wrap align-items-center"},wt={class:"bi bi-info-circle fst-normal"},_t={class:"col-12 d-flex flex-wrap justify-content-between"},kt={class:"col-12 col-xl-6"},Ct={class:"mt-2 col-12 col-xl-5 text-xl-center"},Dt={class:"form-check form-check-inline"},Bt={class:"form-check form-check-inline"},Mt={class:"col-12 col-xl-6 mb-3"},zt={for:"product_quantity",class:"form-label fw-bold d-flex flex-wrap justify-content-start"},It={class:"infoStyle text-secondary fw-normal d-flex flex-wrap align-items-center"},Vt={class:"bi bi-info-circle me-2 fst-normal"},Ft={class:"col-12"},St={class:"mb-0 py-2 fw-bold"},Et={class:"px-1 list-group-item col-12 col-xl-3 d-flex"},Nt={class:"pe-1 fst-normal"},At={class:"mb-0 col-10 col-sm-auto"},qt={key:0,class:"mb-0"},jt={class:"px-0 list-group-item col-12 col-xl-4 d-flex flex-column justify-content-center"},Ut=["onUpdate:modelValue","id","disabled"],Pt={class:"px-0 list-group-item col-12 col-xl-3 d-flex flex-column justify-content-center"},Lt=["onUpdate:modelValue","id"],Qt={class:"d-none d-xl-block list-group-item col-1 align-content-center"},Wt=["onClick"],Ht={class:"d-block d-xl-none position-absolute delBtn-xs list-group"},Ot=["onClick"],Xt={class:"my-3 col-12"};function Tt(o,t,c,d,a,l){const M=C("CustomizeBaseDataModal"),z=C("InstructionModal");return i(),n("main",R,[t[49]||(t[49]=s("h3",{class:"text-center mb-4"},"營養標示製作",-1)),s("section",Z,[s("input",{onChange:t[0]||(t[0]=e=>l.searchFood(e.target.value)),type:"search",class:"form-control",id:"searchInput",placeholder:"請輸入食物成分搜尋"},null,32),t[18]||(t[18]=s("label",{for:"searchInput"},"請輸入食物名稱搜尋",-1))]),s("div",G,[s("div",K,[s("section",Y,[s("div",$,[s("button",{onClick:t[1]||(t[1]=(...e)=>l.showBuiltInDataBase&&l.showBuiltInDataBase(...e)),type:"button",class:w(["col-12 col-md m-1 me-1 btn btn-sm",a.isBuiltIn?"btn-primary":"btn-outline-primary"])}," 內建資料庫 ",2),s("button",{onClick:t[2]||(t[2]=(...e)=>l.showCustomizeDataBase&&l.showCustomizeDataBase(...e)),type:"button",class:w(["col-12 col-md m-1 me-1 btn btn-sm",a.isCustomize?"btn-primary":"btn-outline-primary"])}," 自定義資料庫 ",2)]),s("section",null,[a.filteredData.length===0&&a.filteredCustomizeData.length===0?(i(),n("div",tt,[t[19]||(t[19]=s("p",{class:"mb-2 fw-bold px-3"},"皆無相符品項",-1)),t[20]||(t[20]=s("p",{class:"px-3"},"若該品項有營養標示，可自行新增資料",-1)),s("button",{onClick:t[3]||(t[3]=(...e)=>l.openCustomizeBaseDataModal&&l.openCustomizeBaseDataModal(...e)),type:"button",class:"btn btn-sm btn-outline-primary"}," 新增自定義資料 ")])):(i(),n("div",st,[a.isBuiltIn?(i(),n("section",et,[(i(!0),n(v,null,y(a.filteredData,e=>(i(),n("button",{key:e.id,onClick:p=>l.chooseSample(e),type:"button",class:"list-group-item list-group-item-action px-1","aria-current":"true"},[s("p",lt,u(e.sample_name),1),e.common_name?(i(),n("p",it," 俗名:"+u(e.common_name),1)):r("",!0),e.content_description?(i(),n("p",nt,u(e.content_description),1)):r("",!0)],8,ot))),128)),a.filteredData.length===0?(i(),n("div",at,[t[21]||(t[21]=s("p",{class:"mb-0 text-center fw-bold"},"內建資料庫中",-1)),t[22]||(t[22]=s("p",{class:"mb-0 text-center fw-bold"},"無相符品項",-1)),t[23]||(t[23]=s("p",{class:"px-3"},"若該品項有營養標示，可自行新增資料",-1)),s("button",{onClick:t[4]||(t[4]=(...e)=>l.openCustomizeBaseDataModal&&l.openCustomizeBaseDataModal(...e)),type:"button",class:"btn btn-sm btn-outline-primary"}," 新增自定義資料 ")])):r("",!0)])):r("",!0),a.isCustomize?(i(),n("section",dt,[(i(!0),n(v,null,y(a.filteredCustomizeData,e=>(i(),n("button",{key:e.id,onClick:p=>l.chooseSample(e),type:"button",class:"list-group-item list-group-item-action px-1","aria-current":"true"},[s("p",mt,u(e.sample_name),1),e.common_name?(i(),n("p",ut," 俗名："+u(e.common_name),1)):r("",!0)],8,rt))),128)),a.filteredCustomizeData.length===0?(i(),n("div",ct,[t[24]||(t[24]=s("p",{class:"mb-0 text-center fw-bold"},"自定義資料庫中",-1)),t[25]||(t[25]=s("p",{class:"mb-2 text-center fw-bold"},"無相符品項",-1)),t[26]||(t[26]=s("p",{class:"px-3"},"若該品項有營養標示，可自行新增資料",-1)),s("button",{onClick:t[5]||(t[5]=(...e)=>l.openCustomizeBaseDataModal&&l.openCustomizeBaseDataModal(...e)),type:"button",class:"btn btn-sm btn-outline-primary"}," 新增自定義資料 ")])):r("",!0)])):r("",!0)]))])]),s("form",{id:"form_id",onSubmit:t[17]||(t[17]=E((...e)=>l.submitForm&&l.submitForm(...e),["prevent"])),class:"row mx-0 mt-2 pe-1 align-content-start col-7 col-xl formVisibleHeight overflow-y-auto",novalidate:""},[s("section",ft,[t[27]||(t[27]=s("label",{for:"productName",class:"form-label fw-bold d-flex justify-content-start"},[s("div",{class:"pe-1 d-flex align-items-center"},[s("i",{class:"text-danger fst-normal"},"＊")]),g(" 商品名稱 ")],-1)),m(s("input",{"onUpdate:modelValue":t[6]||(t[6]=e=>o.product.title=e),type:"text",class:"form-control",id:"productName",placeholder:"請輸入商品名稱",required:""},null,512),[[f,o.product.title,void 0,{trim:!0}]]),t[28]||(t[28]=s("div",{class:"invalid-feedback"},"此欄位為必填",-1))]),s("section",pt,[s("label",bt,[s("div",gt,[t[29]||(t[29]=s("i",{class:"text-danger fst-normal pe-1"},"＊",-1)),t[30]||(t[30]=s("span",{class:"me-1"},"以下食材總量共可製成幾份成品？",-1)),s("i",{onClick:t[7]||(t[7]=e=>l.openInstructionModal("productQty")),class:"showInfo bi bi-question-circle text-primary fw-normal fst-normal infoStyle d-inline-block"}," 說明 ")])]),m(s("input",{"onUpdate:modelValue":t[8]||(t[8]=e=>o.product.numberOfCopy=e),type:"number",min:"1",class:"form-control",id:"number_of_copies",placeholder:"輸入共可製成幾份成品",required:""},null,512),[[f,o.product.numberOfCopy]]),t[31]||(t[31]=s("div",{class:"invalid-feedback"},"此欄位為必填，且需大於等於 1",-1))]),s("section",vt,[s("div",yt,[s("label",ht,[t[33]||(t[33]=s("div",{class:"pe-1 d-flex align-items-center"},[s("i",{class:"text-danger fst-normal"},"＊")],-1)),t[34]||(t[34]=s("span",{class:"me-2"},"每一份量",-1)),s("div",xt,[s("i",wt,[t[32]||(t[32]=g(" 將顯示在每一份量的位置 ")),s("i",{onClick:t[9]||(t[9]=e=>l.openInstructionModal("perServing")),class:"showInfo bi bi-question-circle fst-normal text-primary d-inline-block"}," 顯示圖示 ")])])]),s("div",_t,[s("div",kt,[m(s("input",{"onUpdate:modelValue":t[10]||(t[10]=e=>o.product.perPortionInfomation.perWeight=e),type:"number",min:"1",class:"form-control me-3",id:"net_weight",placeholder:"輸入克數或毫升數",required:""},null,512),[[f,o.product.perPortionInfomation.perWeight]]),t[35]||(t[35]=s("div",{class:"invalid-feedback"}," 此欄位為必填，且需大於等於 1 ",-1))]),s("div",Ct,[s("div",Dt,[m(s("input",{"onUpdate:modelValue":t[11]||(t[11]=e=>o.product.perPortionInfomation.unit=e),class:"form-check-input",type:"radio",id:"gram",value:"公克"},null,512),[[_,o.product.perPortionInfomation.unit]]),t[36]||(t[36]=s("label",{class:"form-check-label",for:"gram"},"公克",-1))]),s("div",Bt,[m(s("input",{"onUpdate:modelValue":t[12]||(t[12]=e=>o.product.perPortionInfomation.unit=e),class:"form-check-input",type:"radio",id:"milliliter",value:"毫升"},null,512),[[_,o.product.perPortionInfomation.unit]]),t[37]||(t[37]=s("label",{class:"form-check-label",for:"milliliter"}," 毫升 ",-1))])])])])]),s("section",Mt,[s("label",zt,[t[39]||(t[39]=s("div",{class:"pe-1 d-flex align-items-center"},[s("i",{class:"text-danger fst-normal"},"＊")],-1)),t[40]||(t[40]=s("span",{class:"me-1"},"本包裝含幾份成品？",-1)),s("div",It,[s("i",Vt,[t[38]||(t[38]=g(" 將顯示在本包裝含幾份的位置 ")),s("i",{onClick:t[13]||(t[13]=e=>l.openInstructionModal("howMany")),class:"showInfo bi bi-question-circle fst-normal text-primary d-inline-block"}," 顯示圖示 ")])])]),m(s("input",{"onUpdate:modelValue":t[14]||(t[14]=e=>o.product.productQty=e),type:"number",min:"1",class:"form-control",id:"product_quantity",placeholder:"輸入本包裝含幾份成品",required:""},null,512),[[f,o.product.productQty]]),t[41]||(t[41]=s("div",{class:"invalid-feedback"},"此欄位為必填，且需大於等於 1",-1))]),s("section",Ft,[s("p",St,[t[42]||(t[42]=s("span",{class:"text-danger"},"＊",-1)),t[43]||(t[43]=g(" 從左邊資料庫點選成分，並填入各欄位所需資料 ")),s("i",{onClick:t[15]||(t[15]=e=>l.openInstructionModal("totalWeight")),class:"showInfo bi bi-question-circle text-primary fw-normal fst-normal ps-1 infoStyle d-inline-block"}," 說明 ")]),(i(!0),n(v,null,y(o.product.ingredients,(e,p)=>(i(),n("ul",{key:e.id,class:"border-top rounded-0 position-relative col-12 list-group list-group-horizontal-xl d-flex flex-wrap justify-content-between"},[s("li",Et,[s("i",Nt,u(p+1)+".",1),s("div",null,[s("p",At,u(e.sample_name),1),e.common_name?(i(),n("p",qt," 俗名:"+u(e.common_name),1)):r("",!0)])]),s("li",jt,[m(s("input",{"onUpdate:modelValue":b=>e.foodName=b,type:"text",id:"foodName"+p,disabled:e.details.category==="自定義",placeholder:"輸入欲示於外包裝成分",class:"form-control",required:""},null,8,Ut),[[f,e.foodName,void 0,{trim:!0}]]),t[44]||(t[44]=s("div",{class:"invalid-feedback"},"此欄位為必填",-1))]),s("li",Pt,[m(s("input",{"onUpdate:modelValue":b=>e.grams=b,type:"number",id:"grams"+p,min:"0.1",step:"0.1",placeholder:"輸入該成分『 總克數 』",class:"form-control",required:""},null,8,Lt),[[f,e.grams]]),t[45]||(t[45]=s("div",{class:"invalid-feedback"},"此欄位為必填，且需大於 0",-1))]),s("li",Qt,[s("button",{onClick:b=>l.delField(e),type:"button",class:"btn btn-outline-danger btn-sm d-block"},t[46]||(t[46]=[s("i",{class:"bi bi-x-lg"},null,-1)]),8,Wt)]),s("li",Ht,[s("button",{onClick:b=>l.delField(e),type:"button",class:"btn btn-outline-danger btn-sm"},t[47]||(t[47]=[s("i",{class:"bi bi-x-lg"},null,-1)]),8,Ot)])]))),128)),s("div",Xt,[s("button",{type:"button",class:"btn btn-outline-primary w-100",onClick:t[16]||(t[16]=(...e)=>l.addNewField&&l.addNewField(...e))}," 新增欄位 ")])])],32)]),t[48]||(t[48]=s("div",{class:"col-12 text-end mb-4 px-3"},[s("button",{form:"form_id",type:"submit",class:"col-12 col-xl-9 btn btn-primary"}," 送出以上資料 ")],-1))]),k(M,{ref:"customizeBaseDataModal"},null,512),k(z,{ref:"instructionModal"},null,512)])}const Yt=B(J,[["render",Tt],["__scopeId","data-v-da8d0430"]]);export{Yt as default};
